include ../mixins/flash-messages

doctype
html
	head
		meta(charset="utf-8")
		block head
		title= title || '基于keystone的电商'
		include ./link
	body
		include ./header
		block content
		include ./footer
		script(type='text/javascript', src='js/jquery.min.js')
		script(type='text/javascript', src='js/bootstrap.min.js')
		script(type='text/javascript', src='js/revslider.js')
		script(type='text/javascript', src='js/common.js')
		script(type='text/javascript', src='js/countdown.js')
		script(type='text/javascript', src='js/jquery.bxslider.min.js')
		script(type='text/javascript', src='js/owl.carousel.min.js')
		script(type='text/javascript', src='js/jquery.mobile-menu.min.js')
		script(type='text/javascript').
			$(document).ready(function(){
				$('#thm-rev-slider').show().revolution({//购物车显示
					dottedOverlay: 'none',
					delay: 5000,
					startwidth: 0,
					startheight:570,
					hideThumbs: 200,
					thumbWidth: 200,
					thumbHeight: 50,
					thumbAmount: 2,
					navigationType: 'thumb',
					navigationArrows: 'solo',
					navigationStyle: 'round',
					touchenabled: 'on',
					onHoverStop: 'on',
					swipe_velocity: 0.7,
					swipe_min_touches: 1,
					swipe_max_touches: 1,
					drag_block_vertical: false,
					spinner: 'spinner0',
					keyboardNavigation: 'off',
					navigationHAlign: 'center',
					navigationVAlign: 'bottom',
					navigationHOffset: 0,
					navigationVOffset: 20,
					soloArrowLeftHalign: 'left',
					soloArrowLeftValign: 'center',
					soloArrowLeftHOffset: 20,
					soloArrowLeftVOffset: 0,
					soloArrowRightHalign: 'right',
					soloArrowRightValign: 'center',
					soloArrowRightHOffset: 20,
					soloArrowRightVOffset: 0,
					shadow: 0,
					fullWidth: 'on',
					fullScreen: 'on',
					stopLoop: 'off',
					stopAfterLoops: -1,
					stopAtSlide: -1,
					shuffle: 'off',
					autoHeight: 'on',
					forceFullWidth: 'off',
					fullScreenAlignForce: 'off',
					minFullScreenHeight: 0,
					hideNavDelayOnMobile: 1500,
					hideThumbsOnMobile: 'off',
					hideBulletsOnMobile: 'off',
					hideArrowsOnMobile: 'off',
					hideThumbsUnderResolution: 0,
					hideSliderAtLimit: 0,
					hideCaptionAtLimit: 0,
					hideAllCaptionAtLilmit: 0,
					startWithSlide: 0,
					fullScreenOffsetContainer: ''
				});

				var i,j,fir_num;//处理分类
				for(i = 0,fir_num = 0; i < categories.length; i++){
					if(!categories[i].parent){//一级分类
						console.log("in:"+i);
						fir_num++;
						categories[i].sec_categories = [];
					}
					else{//二级分类
						for(j = 0; j < fir_num; j++)
							if(categories[j]._id.equals(categories[i].parent))
								categories[j].sec_categories.push(categories[i]);
					}
				}
				first_categories = result.slice(0,fir_num);
			});
		block js
